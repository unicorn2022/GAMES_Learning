[TOC]

# 十、物理：基础理论和算法

## 10.1	物理对象与形状

### 10.1.1	Actor

1. static actor：静态物体，不移动，不用解算
2. dynamic actor：动态物体，每一帧都需要计算其状态
3. trigger：触发器，和物理世界没有关系
4. kinematic actor：运动学物体，无视物理规则，直接由游戏逻辑控制

<img src="AssetMarkdown/image-20230727110520872.png" alt="image-20230727110520872" style="zoom:80%;" />

### 10.1.2	Actor Shapes

<img src="AssetMarkdown/image-20230727110718269.png" alt="image-20230727110718269" style="zoom:80%;" />

### 10.1.3	Shape属性

质量 Mass & 密度 Density

<img src="AssetMarkdown/image-20230727111612952.png" alt="image-20230727111612952" style="zoom:80%;" />

质心 Center of Mass

<img src="AssetMarkdown/image-20230727111727898.png" alt="image-20230727111727898" style="zoom:80%;" />

物理材质：摩擦系数 Friction、弹性系数 Restitution

<img src="AssetMarkdown/image-20230727111749362.png" alt="image-20230727111749362" style="zoom:80%;" />

## 10.2	力与运动

### 10.2.1	力的种类

Force：有一定持续时间的力，如重力、拉力、摩擦力

<img src="AssetMarkdown/image-20230727114748641.png" alt="image-20230727114748641" style="zoom:80%;" />

Impulse：冲量

<img src="AssetMarkdown/image-20230727114857546.png" alt="image-20230727114857546" style="zoom:80%;" />

### 10.2.2	移动

显式欧拉法：用当前的力&速度计算位移

1. 优点：容易计算
2. 缺点：能量不守恒

<img src="AssetMarkdown/image-20230727143630198.png" alt="image-20230727143630198" style="zoom:80%;" />

隐式欧拉法：用未来的力&速度计算位移

1. 优点：能量会衰减，从而保证计算是稳定的，衰减很小时可以被视为转化为热能
2. 缺点：如果力是取决于位置的，那么在位置不确定的情况下，无法知道未来的力

<img src="AssetMarkdown/image-20230727143510570.png" alt="image-20230727143510570" style="zoom:80%;" />

半隐式欧拉法：用当前的力、未来的速度计算位移

1. 优点：更加稳定，并且容易计算
2. 缺点：积分出来的周期会比实际的周期长一点，导致有一定的相位差

<img src="AssetMarkdown/image-20230727144235099.png" alt="image-20230727144235099" style="zoom:80%;" />

## 10.3	刚体动力学

### 10.3.1	质点动力学

<img src="AssetMarkdown/image-20230727144551982.png" alt="image-20230727144551982" style="zoom:80%;" />

### 10.3.2	基础概念

<img src="AssetMarkdown/image-20230727144854761.png" alt="image-20230727144854761" style="zoom:80%;" />

<img src="AssetMarkdown/image-20230727145512765.png" alt="image-20230727145512765" style="zoom:80%;" />

<img src="AssetMarkdown/image-20230727145535306.png" alt="image-20230727145535306" style="zoom:80%;" />

<img src="AssetMarkdown/image-20230727145737642.png" alt="image-20230727145737642" style="zoom: 80%;" />

<img src="AssetMarkdown/image-20230727145758977.png" alt="image-20230727145758977" style="zoom:80%;" />

<img src="AssetMarkdown/image-20230727150006906.png" alt="image-20230727150006906" style="zoom:80%;" />

<img src="AssetMarkdown/image-20230727150041602.png" alt="image-20230727150041602" style="zoom:80%;" />

<img src="AssetMarkdown/image-20230727150231290.png" alt="image-20230727150231290" style="zoom:80%;" />

<img src="AssetMarkdown/image-20230727150318355.png" alt="image-20230727150318355" style="zoom:80%;" />

## 10.4	碰撞检测

### 10.4.1	两个阶段

1. Broad Phase：使用AABB包围盒，快速筛除一些不会碰撞的物体
2. Narrow Phase：精确判断是否能够碰撞，生成碰撞信息

<img src="AssetMarkdown/image-20230727151246689.png" alt="image-20230727151246689" style="zoom:80%;" />

### 10.4.2	Broad Phase

#### 10.4.2.1	BVH树

<img src="AssetMarkdown/image-20230727151333377.png" alt="image-20230727151333377" style="zoom:80%;" />

<img src="AssetMarkdown/image-20230727151359255.png" alt="image-20230727151359255" style="zoom:80%;" />

#### 10.4.2.2	Sort and Sweep

对于AABB包围盒来说：

1. 将每个包围盒按照x轴上的两个边界排序
2. 如果在轴上分离，则一定无法碰撞
3. 如果在轴上交错，则可能碰撞，此时计算y轴是否交错
4. 只有两个轴上都交错，才会碰撞

<img src="AssetMarkdown/image-20230727151415157.png" alt="image-20230727151415157" style="zoom:80%;" />

更新时：

1. 相当于在一个已经排好序的数组中，更新某个数的位置，效率很高

<img src="AssetMarkdown/image-20230727151708077.png" alt="image-20230727151708077" style="zoom:80%;" />

### 10.4.3	Narrow Phase

1. 准确检测碰撞
2. 生成碰撞信息
   1. 碰撞采样：生成碰撞点的集合
   2. 碰撞法线
   3. 穿透深度

<img src="AssetMarkdown/image-20230727171236961.png" alt="image-20230727171236961" style="zoom:80%;" />

#### 10.4.3.1	基础图形碰撞检测

<img src="AssetMarkdown/image-20230727172955545.png" alt="image-20230727172955545" style="zoom:80%;" />

<img src="AssetMarkdown/image-20230727173031040.png" alt="image-20230727173031040" style="zoom:80%;" />

<img src="AssetMarkdown/image-20230727175222136.png" alt="image-20230727175222136" style="zoom:80%;" />

#### 10.4.3.2	Minkowski算法

<img src="AssetMarkdown/image-20230727175329180.png" alt="image-20230727175329180" style="zoom:80%;" />